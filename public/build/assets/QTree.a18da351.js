import{b as X,q as se,h as f,aM as fe,x as H,aF as he,f as m,k as V,j as ve,D as ye,aJ as ke,aO as be,a4 as J,N as G,O as ge,b0 as xe,ay as W}from"./app.3d0443e2.js";import{Q as _e}from"./QCheckbox.f712fdb1.js";import{u as Te,a as qe}from"./use-dark.46133ca7.js";var Se=X({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(i,{slots:q,emit:g}){let _=!1,T,S,y=null,k=null,h,K;function C(){T&&T(),T=null,_=!1,y!==null&&(clearTimeout(y),y=null),k!==null&&(clearTimeout(k),k=null),S!==void 0&&S.removeEventListener("transitionend",h),h=null}function F(c,x,o){x!==void 0&&(c.style.height=`${x}px`),c.style.transition=`height ${i.duration}ms cubic-bezier(.25, .8, .50, 1)`,_=!0,T=o}function L(c,x){c.style.overflowY=null,c.style.height=null,c.style.transition=null,C(),x!==K&&g(x)}function $(c,x){let o=0;S=c,_===!0?(C(),o=c.offsetHeight===c.scrollHeight?0:void 0):(K="hide",c.style.overflowY="hidden"),F(c,o,x),y=setTimeout(()=>{y=null,c.style.height=`${c.scrollHeight}px`,h=b=>{k=null,(Object(b)!==b||b.target===c)&&L(c,"show")},c.addEventListener("transitionend",h),k=setTimeout(h,i.duration*1.1)},100)}function w(c,x){let o;S=c,_===!0?C():(K="show",c.style.overflowY="hidden",o=c.scrollHeight),F(c,o,x),y=setTimeout(()=>{y=null,c.style.height=0,h=b=>{k=null,(Object(b)!==b||b.target===c)&&L(c,"hide")},c.addEventListener("transitionend",h),k=setTimeout(h,i.duration*1.1)},100)}return se(()=>{_===!0&&C()}),()=>f(fe,{css:!1,appear:i.appear,onEnter:$,onLeave:w},q.default)}});const me=["none","strict","leaf","leaf-filtered"];var Ee=X({name:"QTree",props:{...Te,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:i=>me.includes(i)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(i,{slots:q,emit:g}){const{proxy:_}=ve(),{$q:T}=_,S=qe(i,T),y=H({}),k=H(i.ticked||[]),h=H(i.expanded||[]);let K={};he(()=>{K={}});const C=m(()=>`q-tree q-tree--${i.dense===!0?"dense":"standard"}`+(i.noConnectors===!0?" q-tree--no-connectors":"")+(S.value===!0?" q-tree--dark":"")+(i.color!==void 0?` text-${i.color}`:"")),F=m(()=>i.selected!==void 0),L=m(()=>i.icon||T.iconSet.tree.icon),$=m(()=>i.controlColor||i.color),w=m(()=>i.textColor!==void 0?` text-${i.textColor}`:""),c=m(()=>{const t=i.selectedColor||i.color;return t?` text-${t}`:""}),x=m(()=>i.filterMethod!==void 0?i.filterMethod:(t,l)=>{const e=l.toLowerCase();return t[i.labelKey]&&t[i.labelKey].toLowerCase().indexOf(e)>-1}),o=m(()=>{const t={},l=(e,r)=>{const n=e.tickStrategy||(r?r.tickStrategy:i.tickStrategy),d=e[i.nodeKey],u=e[i.childrenKey]&&e[i.childrenKey].length>0,E=e.disabled!==!0&&F.value===!0&&e.selectable!==!1,v=e.disabled!==!0&&e.expandable!==!1,ue=n!=="none",N=n==="strict",R=n==="leaf-filtered",P=n==="leaf"||n==="leaf-filtered";let Q=e.disabled!==!0&&e.tickable!==!1;P===!0&&Q===!0&&r&&r.tickable!==!0&&(Q=!1);let A=e.lazy;A===!0&&y.value[d]!==void 0&&Array.isArray(e[i.childrenKey])===!0&&(A=y.value[d]);const a={key:d,parent:r,isParent:u,lazy:A,disabled:e.disabled,link:e.disabled!==!0&&(E===!0||v===!0&&(u===!0||A===!0)),children:[],matchesFilter:i.filter?x.value(e,i.filter):!0,selected:d===i.selected&&E===!0,selectable:E,expanded:u===!0?h.value.includes(d):!1,expandable:v,noTick:e.noTick===!0||N!==!0&&A&&A!=="loaded",tickable:Q,tickStrategy:n,hasTicking:ue,strictTicking:N,leafFilteredTicking:R,leafTicking:P,ticked:N===!0?k.value.includes(d):u===!0?!1:k.value.includes(d)};if(t[d]=a,u===!0&&(a.children=e[i.childrenKey].map(s=>l(s,a)),i.filter&&(a.matchesFilter!==!0?a.matchesFilter=a.children.some(s=>s.matchesFilter):a.noTick!==!0&&a.disabled!==!0&&a.tickable===!0&&R===!0&&a.children.every(s=>s.matchesFilter!==!0||s.noTick===!0||s.tickable!==!0)===!0&&(a.tickable=!1)),a.matchesFilter===!0&&(a.noTick!==!0&&N!==!0&&a.children.every(s=>s.noTick)===!0&&(a.noTick=!0),P))){if(a.ticked=!1,a.indeterminate=a.children.some(s=>s.indeterminate===!0),a.tickable=a.tickable===!0&&a.children.some(s=>s.tickable),a.indeterminate!==!0){const s=a.children.reduce((Y,oe)=>oe.ticked===!0?Y+1:Y,0);s===a.children.length?a.ticked=!0:s>0&&(a.indeterminate=!0)}a.indeterminate===!0&&(a.indeterminateNextState=a.children.every(s=>s.tickable!==!0||s.ticked!==!0))}return a};return i.nodes.forEach(e=>l(e,null)),t});V(()=>i.ticked,t=>{k.value=t}),V(()=>i.expanded,t=>{h.value=t});function b(t){const l=[].reduce,e=(r,n)=>{if(r||!n)return r;if(Array.isArray(n)===!0)return l.call(Object(n),e,r);if(n[i.nodeKey]===t)return n;if(n[i.childrenKey])return e(null,n[i.childrenKey])};return e(null,i.nodes)}function Z(){return k.value.map(t=>b(t))}function p(){return h.value.map(t=>b(t))}function ee(t){return t&&o.value[t]?o.value[t].expanded:!1}function te(){i.expanded!==void 0?g("update:expanded",[]):h.value=[]}function M(){const t=h.value,l=e=>{e[i.childrenKey]&&e[i.childrenKey].length>0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[i.nodeKey]),e[i.childrenKey].forEach(l))};i.nodes.forEach(l),i.expanded!==void 0?g("update:expanded",t):h.value=t}function B(t,l,e=b(t),r=o.value[t]){if(r.lazy&&r.lazy!=="loaded"){if(r.lazy==="loading")return;y.value[t]="loading",Array.isArray(e[i.childrenKey])!==!0&&(e[i.childrenKey]=[]),g("lazyLoad",{node:e,key:t,done:n=>{y.value[t]="loaded",e[i.childrenKey]=Array.isArray(n)===!0?n:[],ye(()=>{const d=o.value[t];d&&d.isParent===!0&&j(t,!0)})},fail:()=>{delete y.value[t],e[i.childrenKey].length===0&&delete e[i.childrenKey]}})}else r.isParent===!0&&r.expandable===!0&&j(t,l)}function j(t,l){let e=h.value;const r=i.expanded!==void 0;if(r===!0&&(e=e.slice()),l){if(i.accordion&&o.value[t]){const n=[];o.value[t].parent?o.value[t].parent.children.forEach(d=>{d.key!==t&&d.expandable===!0&&n.push(d.key)}):i.nodes.forEach(d=>{const u=d[i.nodeKey];u!==t&&n.push(u)}),n.length>0&&(e=e.filter(d=>n.includes(d)===!1))}e=e.concat([t]).filter((n,d,u)=>u.indexOf(n)===d)}else e=e.filter(n=>n!==t);r===!0?g("update:expanded",e):h.value=e}function ie(t){return t&&o.value[t]?o.value[t].ticked:!1}function z(t,l){let e=k.value;const r=i.ticked!==void 0;r===!0&&(e=e.slice()),l?e=e.concat(t).filter((n,d,u)=>u.indexOf(n)===d):e=e.filter(n=>t.includes(n)===!1),r===!0&&g("update:ticked",e)}function le(t,l,e){const r={tree:_,node:t,key:e,color:i.color,dark:S.value};return W(r,"expanded",()=>l.expanded,n=>{n!==l.expanded&&B(e,n)}),W(r,"ticked",()=>l.ticked,n=>{n!==l.ticked&&z([e],n)}),r}function D(t){return(i.filter?t.filter(l=>o.value[l[i.nodeKey]].matchesFilter):t).map(l=>ce(l))}function ne(t){if(t.icon!==void 0)return f(J,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const l=t.img||t.avatar;if(l)return f("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:l})}function re(){g("afterShow")}function ae(){g("afterHide")}function ce(t){const l=t[i.nodeKey],e=o.value[l],r=t.header&&q[`header-${t.header}`]||q["default-header"],n=e.isParent===!0?D(t[i.childrenKey]):[],d=n.length>0||e.lazy&&e.lazy!=="loaded";let u=t.body&&q[`body-${t.body}`]||q["default-body"];const E=r!==void 0||u!==void 0?le(t,e,l):null;return u!==void 0&&(u=f("div",{class:"q-tree__node-body relative-position"},[f("div",{class:w.value},[u(E)])])),f("div",{key:l,class:`q-tree__node relative-position q-tree__node--${d===!0?"parent":"child"}`},[f("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,onClick:v=>{I(t,e,v)},onKeypress(v){ke(v)!==!0&&(v.keyCode===13?I(t,e,v,!0):v.keyCode===32&&O(t,e,v,!0))}},[f("div",{class:"q-focus-helper",tabindex:-1,ref:v=>{K[e.key]=v}}),e.lazy==="loading"?f(be,{class:"q-tree__spinner",color:$.value}):d===!0?f(J,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:L.value,onClick(v){O(t,e,v)}}):null,e.hasTicking===!0&&e.noTick!==!0?f(_e,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:$.value,dark:S.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:G,"onUpdate:modelValue":v=>{de(e,v)}}):null,f("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?c.value:w.value)},[r?r(E):[ne(t),f("div",t[i.labelKey])]])]),d===!0?i.noTransition===!0?f("div",{class:"q-tree__node-collapsible"+w.value,key:`${l}__q`},[u,f("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},e.expanded?n:null)]):f(Se,{duration:i.duration,onShow:re,onHide:ae},()=>ge(f("div",{class:"q-tree__node-collapsible"+w.value,key:`${l}__q`},[u,f("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":"")},n)]),[[xe,e.expanded]])):u])}function U(t){const l=K[t];l&&l.focus()}function I(t,l,e,r){r!==!0&&U(l.key),F.value&&l.selectable?i.noSelectionUnset===!1?g("update:selected",l.key!==i.selected?l.key:null):l.key!==i.selected&&g("update:selected",l.key===void 0?null:l.key):O(t,l,e,r),typeof t.handler=="function"&&t.handler(t)}function O(t,l,e,r){e!==void 0&&G(e),r!==!0&&U(l.key),B(l.key,!l.expanded,t,l)}function de(t,l){if(t.indeterminate===!0&&(l=t.indeterminateNextState),t.strictTicking)z([t.key],l);else if(t.leafTicking){const e=[],r=n=>{n.isParent?(l!==!0&&n.noTick!==!0&&n.tickable===!0&&e.push(n.key),n.leafTicking===!0&&n.children.forEach(r)):n.noTick!==!0&&n.tickable===!0&&(n.leafFilteredTicking!==!0||n.matchesFilter===!0)&&e.push(n.key)};r(t),z(e,l)}}return i.defaultExpandAll===!0&&M(),Object.assign(_,{getNodeByKey:b,getTickedNodes:Z,getExpandedNodes:p,isExpanded:ee,collapseAll:te,expandAll:M,setExpanded:B,isTicked:ie,setTicked:z}),()=>{const t=D(i.nodes);return f("div",{class:C.value},t.length===0?i.filter?i.noResultsLabel||T.lang.tree.noResults:i.noNodesLabel||T.lang.tree.noNodes:t)}}});export{Ee as Q};
